/*!
 * Colors Picker - ä¸€ä¸ªç±»ä¼¼æµè§ˆå™¨è°ƒè¯•å·¥å…·ä¸­é¢œè‰²é€‰æ‹©å™¨çš„H5ç‰ˆæœ¬çš„å°ç»„ä»¶ã€‚
 * git+https://github.com/hai2007/colors-picker.git
 *
 * author ä½ å¥½2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 0.1.0-alpha
 *
 * Copyright (c) 2021 hai2007 èµ°ä¸€æ­¥ï¼Œå†èµ°ä¸€æ­¥ã€‚
 * Released under the MIT license
 *
 * Date:Mon Nov 29 2021 17:48:20 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)
 */
(function(){"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function(obj){return typeof obj}}else{_typeof=function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function(){};return{s:F,n:function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var normalCompletion=true,didErr=false,err;return{s:function(){it=it.call(o)},n:function(){var step=it.next();normalCompletion=step.done;return step},e:function(e){didErr=true;err=e},f:function(){try{if(!normalCompletion&&it.return!=null)it.return()}finally{if(didErr)throw err}}}}var REGEXP={whitespace:"[\\x20\\t\\r\\n\\f]"};function getStyle(dom,name){var allStyle=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(dom,null):dom.currentStyle;return typeof name==="string"?allStyle.getPropertyValue(name):allStyle}
/*!
   * ğŸŒ - é¢œè‰²æ ¼å¼åŒ–
   * https://github.com/hai2007/browser.js/blob/master/formatColor.js
   *
   * author hai2007 < https://hai2007.gitee.io/sweethome >
   *
   * Copyright (c) 2021-present hai2007 èµ°ä¸€æ­¥ï¼Œå†èµ°ä¸€æ­¥ã€‚
   * Released under the MIT license
   */function formatColor(color){var colorNode=document.getElementsByTagName("head")[0];colorNode.style["color"]=color;var rgba=getStyle(colorNode,"color");var rgbaArray=rgba.replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+REGEXP.whitespace));return[+rgbaArray[0],+rgbaArray[1],+rgbaArray[2],rgbaArray[3]==undefined?1:+rgbaArray[3]]}
/*!
   * ğŸŒ - æä¾›å¸¸ç”¨çš„DOMæ“ä½œæ–¹æ³•
   * https://github.com/hai2007/browser.js/blob/master/xhtml.js
   *
   * author hai2007 < https://hai2007.gitee.io/sweethome >
   *
   * Copyright (c) 2021-present hai2007 èµ°ä¸€æ­¥ï¼Œå†èµ°ä¸€æ­¥ã€‚
   * Released under the MIT license
   */var namespace={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};var xhtml={stopPropagation:function stopPropagation(event){event=event||window.event;if(event.stopPropagation){event.stopPropagation()}else{event.cancelBubble=true}},preventDefault:function preventDefault(event){event=event||window.event;if(event.preventDefault){event.preventDefault()}else{event.returnValue=false}},isNode:function isNode(param){return param&&(param.nodeType===1||param.nodeType===9||param.nodeType===11)},bind:function bind(dom,eventType,callback){if(dom.constructor===Array||dom.constructor===NodeList||dom.constructor===HTMLCollection){for(var i=0;i<dom.length;i++){this.bind(dom[i],eventType,callback)}return}if(window.attachEvent)dom.attachEvent("on"+eventType,callback);else dom.addEventListener(eventType,callback,false)},unbind:function unbind(dom,eventType,handler){if(dom.constructor===Array||dom.constructor===NodeList||dom.constructor===HTMLCollection){for(var i=0;i<dom.length;i++){this.unbind(dom[i],eventType,handler)}return}if(window.detachEvent)dom.detachEvent("on"+eventType,handler);else dom.removeEventListener(eventType,handler,false)},find:function find(context,selectFun,tagName){if(!this.isNode(context))return[];var nodes=context.getElementsByTagName(tagName||"*");var result=[];for(var i=0;i<nodes.length;i++){if(this.isNode(nodes[i])&&(typeof selectFun!="function"||selectFun(nodes[i])))result.push(nodes[i])}return result},children:function children(dom,selectFun){var nodes=dom.childNodes;var result=[];for(var i=0;i<nodes.length;i++){if(this.isNode(nodes[i])&&(typeof selectFun!="function"||selectFun(nodes[i])))result.push(nodes[i])}return result},hasClass:function hasClass(dom,clazzs,notStrict){if(clazzs.constructor!==Array)clazzs=[clazzs];var class_str=" "+(dom.getAttribute("class")||"")+" ";for(var i=0;i<clazzs.length;i++){if(class_str.indexOf(" "+clazzs[i]+" ")>=0){if(notStrict)return true}else{if(!notStrict)return false}}return true},removeClass:function removeClass(dom,clazz){var oldClazz=" "+(dom.getAttribute("class")||"")+" ";var newClazz=oldClazz.replace(" "+clazz.trim()+" "," ");dom.setAttribute("class",newClazz.trim())},addClass:function addClass(dom,clazz){if(this.hasClass(dom,clazz))return;var oldClazz=dom.getAttribute("class")||"";dom.setAttribute("class",oldClazz+" "+clazz)},toNode:function toNode(template,isSvg){var frame;if(isSvg)frame=document.createElementNS(namespace.svg,"svg");else{var frameTagName="div";if(/^<tr[> ]/.test(template)){frameTagName="tbody"}else if(/^<th[> ]/.test(template)||/^<td[> ]/.test(template)){frameTagName="tr"}else if(/^<thead[> ]/.test(template)||/^<tbody[> ]/.test(template)){frameTagName="table"}frame=document.createElement(frameTagName)}frame.innerHTML=template;var childNodes=frame.childNodes;for(var i=0;i<childNodes.length;i++){if(this.isNode(childNodes[i]))return childNodes[i]}},trigger:function trigger(dom,eventType){if(document.createEventObject){dom.fireEvent("on"+eventType,document.createEventObject())}else{var _event=document.createEvent("HTMLEvents");_event.initEvent(eventType,true,false);dom.dispatchEvent(_event)}},getStyle:function getStyle(dom,name){var allStyle=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(dom,null):dom.currentStyle;return typeof name==="string"?allStyle.getPropertyValue(name):allStyle},offsetPosition:function offsetPosition(dom){var left=0;var top=0;top=dom.offsetTop;left=dom.offsetLeft;dom=dom.offsetParent;while(dom){top+=dom.offsetTop;left+=dom.offsetLeft;dom=dom.offsetParent}return{left:left,top:top}},mousePosition:function mousePosition(dom,event){var bounding=dom.getBoundingClientRect();if(!event||!event.clientX)throw new Error("Event is necessary!");return{x:event.clientX-bounding.left,y:event.clientY-bounding.top}},remove:function remove(dom){dom.parentNode.removeChild(dom)},setStyles:function setStyles(dom,styles){for(var key in styles){dom.style[key]=styles[key]}},size:function size(dom,type){var elemHeight,elemWidth;if(type=="content"){elemWidth=dom.clientWidth-(this.getStyle(dom,"padding-left")+"").replace("px","")-(this.getStyle(dom,"padding-right")+"").replace("px","");elemHeight=dom.clientHeight-(this.getStyle(dom,"padding-top")+"").replace("px","")-(this.getStyle(dom,"padding-bottom")+"").replace("px","")}else if(type=="padding"){elemWidth=dom.clientWidth;elemHeight=dom.clientHeight}else if(type=="border"){elemWidth=dom.offsetWidth;elemHeight=dom.offsetHeight}else if(type=="scroll"){elemWidth=dom.scrollWidth;elemHeight=dom.scrollHeight}else{elemWidth=dom.offsetWidth;elemHeight=dom.offsetHeight}return{width:elemWidth,height:elemHeight}},append:function append(el,template){var node=this.isNode(template)?template:this.toNode(template);el.appendChild(node);return node},prepend:function prepend(el,template){var node=this.isNode(template)?template:this.toNode(template);el.insertBefore(node,el.childNodes[0]);return node},after:function after(el,template){var node=this.isNode(template)?template:this.toNode(template);el.parentNode.insertBefore(node,el.nextSibling);return node},before:function before(el,template){var node=this.isNode(template)?template:this.toNode(template);el.parentNode.insertBefore(node,el);return node}};function mount(target,color,callback){var dialog=document.getElementById("colors-picker-dialog"),doit;target._color_=color;if(!dialog){xhtml.append(document.body,"<div id='colors-picker-dialog'\n                style='\n                    position: fixed;\n                    outline: gray solid 1px;\n                    background-color: white;\n                    font-size:0;\n                '>\n            <div style='outline:1px solid gray;position: relative; overflow: hidden;' id='colors-picker-dialog_canvas0_frame'>\n                <canvas\n                    id='colors-picker-dialog_canvas0'\n                    style='width:300px;height:160px;'\n                    width='300px'\n                    height='160px'>\n                        éå¸¸æŠ±æ­‰ï¼Œæ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒcanvas!\n                </canvas>\n                <span\n                    style='\n                        position: absolute;\n                        position: absolute;\n                        width: 12px;\n                        height: 12px;\n                        outline: 1px solid gray;\n                        border-radius: 50%;\n                        right: -6px;\n                        top: -6px;\n                        cursor:pointer;\n                    ' id='colors-picker-dialog_canvas0_btn'></span>\n            </div>\n            <div style='text-align:center;margin:20px 0;'>\n                <div\n                    id='colors-picker-dialog_color'\n                    style='\n                        display:inline-block;\n                        width:40px;\n                        height:40px;\n                        outline:1px solid gray;\n                        border-radius:50%;\n                        margin-right:10px;\n                '></div>\n                <div style='display:inline-block;'>\n                    <div style='outline:1px solid gray;position: relative;' id='colors-picker-dialog_canvas1_frame'>\n                        <canvas\n                            id='colors-picker-dialog_canvas1'\n                            style='\n                                width:200px;\n                                height:16px;\n                            'width='200px'height='16px'>\n                                éå¸¸æŠ±æ­‰ï¼Œæ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒcanvas!\n                        </canvas>\n                        <span\n                            style='\n                                position: absolute;\n                                width: 22px;\n                                height: 22px;\n                                outline: 1px solid gray;\n                                display: inline-block;\n                                border-radius: 50%;\n                                right: -11px;\n                                top: -3.5px;\n                                cursor:pointer;\n                                background: #faf8f8;'\n                            id='colors-picker-dialog_canvas1_btn'></span>\n                    </div>\n                    <div style='outline:1px solid gray;margin-top:10px;position: relative;' id='colors-picker-dialog_canvas2_frame'>\n                        <canvas\n                            id='colors-picker-dialog_canvas2'\n                            style='\n                                width:200px;\n                                height:16px;\n                            'width='200px'height='16px'>\n                                éå¸¸æŠ±æ­‰ï¼Œæ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒcanvas!\n                        </canvas>\n                        <span\n                            style='\n                                position: absolute;\n                                width: 22px;\n                                height: 22px;\n                                outline: 1px solid gray;\n                                display: inline-block;\n                                border-radius: 50%;\n                                right: -11px;\n                                top: -3.5px;\n                                cursor:pointer;\n                                background: #faf8f8;'\n                            id='colors-picker-dialog_canvas2_btn'></span>\n                    </div>\n                </div>\n            </div>\n            <div style='text-align:center;padding:10px;'>\n                <button\n                    id='colors-picker-dialog_btn_cancel'\n                    style='\n                        margin-right:30px;\n                        background-color:white;\n                        width:90px;\n                        border-radius:5px;\n                        cursor:pointer;\n                    '>å–æ¶ˆ</button>\n                <button\n                    id='colors-picker-dialog_btn_checked'\n                    style='\n                        background-color:#449cf6;\n                        color:white;width:90px;\n                        border-radius:5px;\n                        cursor:pointer;\n                    '>ç¡®å®š</button>\n            </div>\n        </div>");dialog=document.getElementById("colors-picker-dialog");dialog.style.display="none";var btn_flag=-1;xhtml.bind(document.getElementById("colors-picker-dialog_canvas0_btn"),"mousedown",(function(){btn_flag=0}));xhtml.bind(document.getElementById("colors-picker-dialog_canvas1_btn"),"mousedown",(function(){btn_flag=1}));xhtml.bind(document.getElementById("colors-picker-dialog_canvas2_btn"),"mousedown",(function(){btn_flag=2}));xhtml.bind(document.body,"mousemove",(function(event){if([0,1,2].indexOf(btn_flag)>-1){var position=xhtml.mousePosition(document.getElementById("colors-picker-dialog_canvas"+btn_flag+"_frame"),event);var btn=document.getElementById("colors-picker-dialog_canvas"+btn_flag+"_btn");if(btn_flag===0){if(position.y>160||position.y<0||position.x<0||position.x>300)return;btn.style.left=position.x-6+"px";btn.style.top=position.y-6+"px"}else{if(position.x<0||position.x>200)return;btn.style.left=position.x-11+"px"}}}));xhtml.bind(document.body,"mouseup",(function(){btn_flag=-1}));xhtml.bind(document.getElementById("colors-picker-dialog_btn_cancel"),"click",(function(){dialog.style.display="none"}));xhtml.bind(document.getElementById("colors-picker-dialog_btn_checked"),"click",(function(){dialog.style.display="none";dialog._colors_picker_.callback("å¼€å‘ä¸­")}))}doit=function doit(){dialog._colors_picker_={callback:callback,target:target};var elPosition=xhtml.offsetPosition(target);var elSize=xhtml.size(target);dialog.style.left=elPosition.left+"px";dialog.style.top=elPosition.top+elSize.height+"px";dialog.style.display="block"};xhtml.bind(target,"click",doit)}var ColorsPicker=function ColorsPicker(el,initColor){var target=el;var color=initColor?formatColor(initColor):[255,255,255,1];var callbacks=[];var ColorsPickerInstance={then:function then(callback){callbacks.push(callback);return ColorsPickerInstance}};mount(target,color,(function(_color){var _iterator=_createForOfIteratorHelper(callbacks),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var callback=_step.value;callback(_color)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}));return ColorsPickerInstance};if((typeof module==="undefined"?"undefined":_typeof(module))==="object"&&_typeof(module.exports)==="object"){module.exports=ColorsPicker}else{window.ColorsPicker=ColorsPicker}})();